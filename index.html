<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Juego Sistema Endocrino</title>
  <style>
    :root{
      --green:#4caf50;
      --panel:#ffffff;
      --bg:#e9f5df;
      --btn:#b7e1cd;
      --btnHover:#99d3b4;
    }
    body{
      font-family: system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,"Helvetica Neue",Arial;
      background: var(--bg);
      margin:0; padding:0;
      min-height:100vh;
      display:flex; align-items:center; justify-content:center;
      overflow-x:hidden;
    }

    /* ---------- Intro / Carrusel ---------- */
    #introCarousel{
      position:fixed; inset:0;
      background:#333;
      display:flex; flex-direction:column; align-items:center; justify-content:center;
      z-index:100;
    }
    #introCarousel img{
      width:min(60%,320px);
      border-radius:1rem;
      box-shadow:0 8px 24px rgba(0,0,0,.45);
      animation:spinY 3s linear infinite;
    }
    #skipBtn{
      margin-top:1.25rem;
      padding:.6rem 1rem;
      background:var(--green); color:#fff;
      border:none; border-radius:.6rem; cursor:pointer;
      font-size:1rem;
    }
    @keyframes spinY{
      0%{ transform:rotateY(0deg) }
      50%{ transform:rotateY(180deg) }
      100%{ transform:rotateY(360deg) }
    }

    /* ---------- Contenedor principal ---------- */
    .container{
      display:none;
      width:min(94vw,560px);
      padding:1rem;
      text-align:center;
    }
    h1{ margin:.5rem 0 0; }
    #namePrompt{ margin:1rem 0; }
    #namePrompt input{
      padding:.6rem .8rem; border:1px solid #ccc; border-radius:.6rem;
      width:min(60%,260px);
    }
    #namePrompt button{
      margin-left:.5rem; padding:.6rem 1rem; border:none;
      border-radius:.6rem; background:var(--green); color:#fff; cursor:pointer;
    }
    #counter{ font-size:1.2rem; margin:.5rem 0 1rem; }

    /* ---------- Tarjeta con flip ---------- */
    .card-wrap{ perspective:1000px; }
    .card{
      width:100%; max-width:520px; margin:0 auto;
      border-radius:1rem;
    }
    .card-inner{
      position:relative; width:100%;
      /* la altura se ajusta por JS => evita cortes */
      transition: transform .6s;
      transform-style:preserve-3d;
    }
    .card.flipped .card-inner{ transform:rotateY(180deg); }

    .face{
      position:absolute; inset:0; /* top/left/right/bottom:0 */
      backface-visibility:hidden;
      border-radius:1rem; overflow:hidden;
      background:var(--panel);
      box-shadow:0 10px 24px rgba(0,0,0,.18);
    }

    .card-front{ cursor:pointer; }
    .card-front img{
      display:block; width:100%; height:auto; /* mantiene proporción */
    }

    .card-back{
      transform:rotateY(180deg);
      display:flex; flex-direction:column; align-items:center;
      padding:1rem;
    }
    .question{ font-weight:700; margin:.25rem 0 1rem; }

    .options{ width:100%; display:flex; flex-direction:column; gap:.5rem; }
    .options button{
      width:92%; margin:0 auto;
      padding:.6rem .8rem; border:none; border-radius:.8rem;
      background:var(--btn); cursor:pointer; font-size:1rem;
    }
    .options button:hover{ background:var(--btnHover); }

    .feedback{ margin-top:1rem; font-weight:700; min-height:1.2em; }

    #nextBtn, #restartBtn{
      margin:1rem .25rem 0; padding:.6rem 1rem;
      border:none; border-radius:.6rem; background:var(--green); color:#fff;
      cursor:pointer; display:none;
    }

    @media (max-width:420px){
      #namePrompt input{ width:100%; margin:.5rem 0; }
      #namePrompt button{ margin-left:0; width:100%; }
      .options button{ font-size:.95rem; }
    }
  </style>
</head>
<body>

  <!-- Intro / Carrusel -->
  <div id="introCarousel">
    <img id="carouselImg" src="2.png" alt="Intro">
    <button id="skipBtn" onclick="endIntro()">¡Comenzar!</button>
  </div>

  <!-- Juego -->
  <div class="container" id="gameContainer">
    <h1 id="welcome">Juego del Sistema Endocrino</h1>

    <div id="namePrompt">
      <label for="playerName">Ingresa tu nombre: </label>
      <input id="playerName" type="text" />
      <button onclick="startGame()">Comenzar</button>
    </div>

    <div id="counter"></div>

    <div class="card-wrap">
      <div class="card" id="card">
        <div class="card-inner" id="cardInner">
          <div class="face card-front" onclick="flipCard()">
            <img id="cardImage" src="" alt="Imagen tarjeta">
          </div>
          <div class="face card-back">
            <div class="question" id="questionText"></div>
            <div class="options" id="optionButtons"></div>
          </div>
        </div>
      </div>
    </div>

    <div id="feedback" class="feedback"></div>
    <button id="nextBtn" onclick="nextCard()">Siguiente</button>
    <button id="restartBtn" onclick="restartGame()">Reiniciar juego</button>
  </div>

  <script>
    /* ---------------- Carrusel de inicio ---------------- */
    let introIndex = 0, introInterval;
    const carouselImages = ['2.png','4.png','6.png','8.png','10.png','12.png','15.png','16.png','17.png'];

    function startIntro(){
      introInterval = setInterval(() => {
        introIndex = (introIndex + 1) % carouselImages.length;
        document.getElementById('carouselImg').src = carouselImages[introIndex];
      }, 1000);
      setTimeout(endIntro, 6000); // auto-skip
    }

    function endIntro(){
      clearInterval(introInterval);
      document.getElementById('introCarousel').style.display = 'none';
      document.getElementById('gameContainer').style.display = 'block';
    }

    window.addEventListener('load', startIntro);

    /* ---------------- Lógica del juego ---------------- */
    let playerName = '', score = 0, current = 0;

    const cards = [
      {img:'2.png', question:'¿Quién produce oxitocina y vasopresina?', options:['Hipófisis','Hipotálamo','Tiroides'], answer:'Hipotálamo',
        explanations:{
          'Hipófisis':'Esto no es así debido a que la hipófisis almacena pero no produce estas hormonas.',
          'Hipotálamo':'Muy bien, el hipotálamo produce oxitocina y vasopresina, que luego se almacenan en la neurohipófisis.',
          'Tiroides':'Esto no es correcto: la tiroides produce tiroxina y T3, no estas hormonas.'
        }
      },
      {img:'4.png', question:'¿Quién es la glándula maestra del sistema endocrino?', options:['Hipotálamo','Tiroides','Hipófisis'], answer:'Hipófisis',
        explanations:{
          'Hipotálamo':'Aunque regula al resto, la “maestra” es la hipófisis.',
          'Tiroides':'La tiroides regula el metabolismo, pero no dirige a otras glándulas.',
          'Hipófisis':'¡Bien! Libera hormonas que controlan otras glándulas.'
        }
      },
      {img:'6.png', question:'¿Dónde se almacenan oxitocina y vasopresina?', options:['Neurohipófisis','Tiroides','Suprarrenales'], answer:'Neurohipófisis',
        explanations:{
          'Neurohipófisis':'Exacto: almacena hormonas producidas por el hipotálamo.',
          'Tiroides':'Produce hormonas tiroideas, no almacena oxitocina/vasopresina.',
          'Suprarrenales':'Secreta adrenalina y cortisol, no estas hormonas.'
        }
      },
      {img:'8.png', question:'¿Qué hormona regula el equilibrio hídrico en riñones?', options:['Adrenalina','Oxitocina','Vasopresina'], answer:'Vasopresina',
        explanations:{
          'Adrenalina':'Actúa en estrés agudo; no regula el agua.',
          'Oxitocina':'Actúa en parto y lactancia.',
          'Vasopresina':'¡Correcto! Aumenta la reabsorción de agua en los riñones.'
        }
      },
      {img:'10.png', question:'¿Qué hormona estimula contracciones uterinas y eyección de leche?', options:['Oxitocina','FSH','TSH'], answer:'Oxitocina',
        explanations:{
          'Oxitocina':'¡Bien! Actúa en el parto y la eyección de leche.',
          'FSH':'Regula la maduración de folículos ováricos.',
          'TSH':'Estimula la tiroides.'
        }
      },
      {img:'12.png', question:'¿Qué parte de la hipófisis produce ACTH, GH y LH?', options:['Adenohipófisis','Hipotálamo','Neurohipófisis'], answer:'Adenohipófisis',
        explanations:{
          'Adenohipófisis':'Correcto: secreta ACTH, GH, LH/FSH, TSH y PRL.',
          'Hipotálamo':'Regula a la hipófisis con hormonas liberadoras.',
          'Neurohipófisis':'Solo almacena oxitocina y vasopresina.'
        }
      },
      {img:'15.png', question:'¿Qué glándula produce estrógenos y progesterona?', options:['Ovario','Hipófisis','Testículos'], answer:'Ovario',
        explanations:{
          'Ovario':'Así es: regula el ciclo menstrual y el embarazo.',
          'Hipófisis':'La hipófisis regula, no produce estas hormonas.',
          'Testículos':'Principalmente producen testosterona.'
        }
      },
      {img:'16.png', question:'¿Qué regula la maduración de los óvulos y el ciclo menstrual?', options:['Testosterona','Progesterona','Estrógeno'], answer:'Estrógeno',
        explanations:{
          'Testosterona':'Hormona androgénica; no regula el ciclo ovárico.',
          'Progesterona':'Prepara el útero para el embarazo; no inicia la maduración.',
          'Estrógeno':'Correcto: participa en la maduración folicular y ciclo.'
        }
      },
      {img:'17.png', question:'¿Qué hormona principal producen los testículos?', options:['Estrógeno','Progesterona','Testosterona'], answer:'Testosterona',
        explanations:{
          'Estrógeno':'Hormona principalmente ovárica/placentaria.',
          'Progesterona':'Producida por ovario/placenta.',
          'Testosterona':'¡Correcto! Determina caracteres sexuales masculinos.'
        }
      }
    ];

    const imgEl = document.getElementById('cardImage');
    const cardInnerEl = document.getElementById('cardInner');

    function adjustCardHeight(){
      // Altura visible de la cara frontal
      const hFront = imgEl.clientHeight || 0;
      // Altura requerida del reverso
      const back = document.querySelector('.card-back');
      const hBack = back.scrollHeight || 0;
      cardInnerEl.style.height = Math.max(hFront, hBack) + 'px';
    }

    // Reajusta cuando cambia el tamaño de la ventana
    window.addEventListener('resize', adjustCardHeight);

    function startGame(){
      const name = document.getElementById('playerName').value.trim();
      if(!name) return;
      playerName = name;
      document.getElementById('namePrompt').style.display = 'none';
      document.getElementById('counter').style.display = 'block';
      score = 0; current = 0;
      loadCard(0);
    }

    function flipCard(){
      document.getElementById('card').classList.toggle('flipped');
      // tras el flip, asegurar altura suficiente
      setTimeout(adjustCardHeight, 50);
    }

    function loadCard(i){
      current = i;
      const data = cards[i];

      // Contador y textos
      document.getElementById('welcome').textContent = `Juego del Sistema Endocrino`;
      document.getElementById('counter').textContent = `${i+1} / ${cards.length}`;
      document.getElementById('questionText').textContent = data.question;

      // Botones opciones
      const opts = document.getElementById('optionButtons');
      opts.innerHTML = '';
      data.options.forEach(op => {
        const b = document.createElement('button');
        b.textContent = op;
        b.onclick = () => validateAnswer(b, data);
        opts.appendChild(b);
      });

      // Estado interfaz
      document.getElementById('feedback').textContent = '';
      document.getElementById('nextBtn').style.display = 'none';
      document.getElementById('card').classList.remove('flipped');

      // Cargar imagen y ajustar altura cuando termina
      imgEl.onload = () => adjustCardHeight();
      imgEl.src = data.img;
    }

    function validateAnswer(btn, data){
      const ok = btn.textContent === data.answer;
      if(ok) score++;
      btn.style.backgroundColor = ok ? '#8fe88f' : '#f28b82';

      const fb = `${playerName || '¡Bien!'}, ${data.explanations[btn.textContent]}`;
      document.getElementById('feedback').textContent = fb;

      // Deshabilitar todas las opciones
      document.querySelectorAll('.options button').forEach(b => b.disabled = true);
      document.getElementById('nextBtn').style.display = 'inline-block';

      // Asegurar que el reverso tenga altura suficiente
      setTimeout(adjustCardHeight, 50);
    }

    function nextCard(){
      if(current + 1 < cards.length){
        loadCard(current + 1);
      }else{
        showResults();
      }
    }

    function showResults(){
      const c = document.getElementById('gameContainer');
      c.innerHTML = `
        <h2>🎉 ${playerName || 'Jugador/a'}, completaste el juego.</h2>
        <p>Puntuación: <b>${score}</b> / ${cards.length}</p>
        <button id="restartBtn" onclick="restartGame()">Reiniciar juego</button>
      `;
    }

    function restartGame(){ location.reload(); }
  </script>
</body>
</html>


